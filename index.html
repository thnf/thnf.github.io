<!DOCTYPE html>
<html id="html" lang="zh-CN">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ä¿¡æ¯å­¦ç½‘ç«™æ€»ç½‘ å¯¼èˆª</title>
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "pmp8on0d5k");
  </script>

    <script type="text/javascript">
           var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?599433e2313d5b601a736a6dea2770f3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
    </script>

      <script type="text/javascript">
           !function(p){"use strict";!function(t){var s=window,e=document,i=p,c="".concat("https:"===e.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),n=e.createElement("script"),r=e.getElementsByTagName("script")[0];n.type="text/javascript",n.setAttribute("charset","UTF-8"),n.async=!0,n.src=c,n.id="LA_COLLECT",i.d=n;var o=function(){s.LA.ids.push(i)};s.LA?s.LA.ids&&o():(s.LA=p,s.LA.ids=[],o()),r.parentNode.insertBefore(n,r)}()}({id:"JuwJmSVQNTdeACxY",ck:"JuwJmSVQNTdeACxY"});
    </script>

      <script defer src="https://clarify.bpuxi.top/script.js" data-website-id="62c6aa81-f4ed-4ba7-bdfb-4d4c2eba865e"></script>
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family: "PingFang SC","Microsoft YaHei",sans-serif; }
  body, html { width:100%; height:100%; background:#f5f5f5; }

  /* ä¾§è¾¹æ æ ·å¼ */
  .sidebar {
    position: fixed; left:-250px; top:0; width:250px; height:100%;
    background:#fff; border-right:1px solid #ddd; transition:0.3s; overflow-y:auto; z-index:10;
    box-shadow: 2px 0 10px rgba(0,0,0,0.1);
  }
  .sidebar.open { left:0; }
  .sidebar .top { font-size:18px; padding:16px; text-align:center; background:#f1f3f4; font-weight:bold; }
  .sidebar ul { list-style:none; margin:0; padding:0; }
  .sidebar ul li button {
    width:100%; padding:12px 20px; border:none; background:none; text-align:left; font-size:16px;
    cursor:pointer; transition:0.2s;
  }
  .sidebar ul li button:hover { background:#f1f3f4; }

  /* å†…å®¹åŒºæ ·å¼ */
  .content { margin-left:0; transition:0.3s; height:100vh; overflow:hidden; }
  .content.open { margin-left:250px; }

  /* é¡¶éƒ¨æŒ‰é’® */
  #toggleSidebar {
    position:fixed; top:10px; left:10px; z-index:20;
    padding:8px 12px; background:#4285f4; color:#fff; border:none; border-radius:4px; cursor:pointer;
  }
  #toggleSidebar:hover { background:#357ae8; }

  /* å¤œé—´æ¨¡å¼æŒ‰é’® */
  #moshi {
    border-radius:14px; padding:8px 16px; height:40px; margin:8px;
    border:none; background:#00ffff; color:#333; font-weight:bold; font-size:14px; cursor:pointer;
    box-shadow:0 2px 6px rgba(0,0,0,0.2); transition:0.3s;
  }
  #moshi:hover { background:#00dddd; }

  /* é—®å€™æ–‡å­— */
  #titleText { font-size:16px; padding:10px; text-align:center; background:#f1f3f4; }

  /* iframeæ ·å¼ */
  #main { width:100%; height:100%; border:none; }

  /* æ‰‹æœºé€‚é… */
  @media(max-width:768px) {
    .sidebar { width:200px; }
    .content.open { margin-left:200px; }
  }
</style>
</head>

<body>
<button id="toggleSidebar">â˜°</button>
<div class="sidebar" id="sidebar">
  <div class="top">ä¿¡æ¯å­¦æ€»ç½‘å¯¼èˆª</div>
  <div id="titleText">æ¬¢è¿è®¿é—®ä¿¡æ¯å­¦ç½‘ç«™æ€»ç½‘</div>
  <button id="moshi" name="baitian" onclick="moshi()">åˆ‡æ¢å¤œé—´</button>
  <ul>
    <li><button onclick="switchPage('bpuxi')">ğŸ  ä¸»é¡µ</button></li>
    <li><button onclick="switchPage('jiaoyu')">ğŸ“ æ•™è‚²ç‰ˆ</button></li>
    <li><button onclick="switchPage('yule')">ğŸ­ å¨±ä¹ç‰ˆ</button></li>
    <li><button onclick="switchPage('tv')">ğŸ“º TVç‰ˆ</button></li>
    <li><button onclick="switchPage('betaweb')">âš¡ æŠ¢å…ˆç‰ˆ</button></li>
    <li><button onclick="switchPage('tools')">ğŸ§° å·¥å…·ç®±</button></li>
  </ul>
</div>

<div class="content" id="content">
  <iframe id="main" src=""></iframe>
</div>

<script>
  // æ ¸å¿ƒé…ç½®ï¼ˆæç®€ï¼šåªä¿ç•™å¿…è¦ç™½åå•ï¼‰
  const STORAGE_KEY = 'last_visited_page';
  const VALID_FILES = ['bpuxi.html', 'jiaoyu.html', 'yule.html', 'tv.html', 'betaweb.html', 'tools.html'];
  const IFRAME_ID = 'main';

  // å…¨å±€å˜é‡
  let currentIframe = document.getElementById(IFRAME_ID);

  // ================== ä¾§è¾¹æ åˆ‡æ¢ ==================
  document.getElementById('toggleSidebar').onclick = function() {
    document.querySelector('.sidebar').classList.toggle('open');
    document.querySelector('.content').classList.toggle('open');
  }

  // ================== å¤œé—´æ¨¡å¼ ==================
  function moshi() {
    const btn = document.getElementById('moshi');
    const html = document.getElementById('html');
    if (btn.name === 'baitian') {
      btn.name = 'yejian';
      btn.innerText = 'åˆ‡æ¢æ—¥é—´';
      html.style.filter = 'grayscale(100%) invert(74%) hue-rotate(74deg) brightness(84%) saturate(400%) contrast(200%) sepia(24%)';
      btn.style.backgroundColor = '#333';
      btn.style.color = '#00ffff';
    } else {
      btn.name = 'baitian';
      btn.innerText = 'åˆ‡æ¢å¤œé—´';
      html.style.filter = 'none';
      btn.style.backgroundColor = '#00ffff';
      btn.style.color = '#333';
    }
  }

  // ================== 1. æ ¸å¿ƒï¼šè·å–iframeçœŸå®URLï¼ˆæŒ‰è¦æ±‚å¼ºåˆ¶ä½¿ç”¨contentWindowï¼‰ ==================
  function getIframeTrueURL() {
    try {
      // å¼ºåˆ¶ä½¿ç”¨ç›®æ ‡APIï¼šparent.document.getElementById(IFRAME_ID).contentWindow.location.href
      const trueURL = parent.document.getElementById(IFRAME_ID).contentWindow.location.href;
      console.log('[è·å–æˆåŠŸ] iframeçœŸå®URL:', trueURL);
      return trueURL;
    } catch (error) {
      // æœ¬åœ°fileåè®®å…¼å®¹ï¼šéƒ¨åˆ†æµè§ˆå™¨æœ¬åœ°ç¯å¢ƒé™åˆ¶contentWindowï¼Œé™çº§ç”¨src
      const fallbackURL = currentIframe.src;
      console.log('[è·å–å¤±è´¥ï¼ˆæœ¬åœ°å…¼å®¹ï¼‰] é™çº§ä½¿ç”¨src:', fallbackURL, 'é”™è¯¯åŸå› :', error.message);
      return fallbackURL;
    }
  }

  // ================== 2. ä»URLæå–æ–‡ä»¶åï¼ˆæç®€é€»è¾‘ï¼‰ ==================
  function getFileNameFromURL(url) {
    return url.split('/').pop().split('?')[0].split('#')[0];
  }

  // ================== 3. ä¿å­˜è®°å½•ï¼ˆåªå­˜æ–‡ä»¶åï¼Œé¿å…è·¯å¾„å…¼å®¹é—®é¢˜ï¼‰ ==================
  function saveRecord() {
    const trueURL = getIframeTrueURL();
    const fileName = getFileNameFromURL(trueURL);
    
    // åªä¿å­˜åˆæ³•æ–‡ä»¶
    if (VALID_FILES.includes(fileName)) {
      // localStorageå­˜å‚¨
      if (typeof localStorage !== 'undefined') {
        localStorage.setItem(STORAGE_KEY, fileName);
        console.log('[ä¿å­˜æˆåŠŸ] è®°å½•æ–‡ä»¶å:', fileName);
      }
      // Cookieå­˜å‚¨ï¼ˆå¤‡ç”¨ï¼‰
      document.cookie = `${STORAGE_KEY}=${fileName}; max-age=${30*24*60*60}; path=/; SameSite=Lax`;
    } else {
      console.log('[ä¿å­˜å¤±è´¥] éæ³•æ–‡ä»¶:', fileName);
    }
  }

  // ================== 4. è¯»å–è®°å½•ï¼ˆåªè¯»æ–‡ä»¶åï¼Œç›´æ¥æ‹¼æ¥è·¯å¾„ï¼‰ ==================
  function loadRecord() {
    // ä¼˜å…ˆè¯»localStorage
    if (typeof localStorage !== 'undefined') {
      const savedFile = localStorage.getItem(STORAGE_KEY);
      if (savedFile && VALID_FILES.includes(savedFile)) {
        console.log('[è¯»å–æˆåŠŸ] æœ¬åœ°å­˜å‚¨è®°å½•:', savedFile);
        return savedFile;
      }
    }

    // è¯»Cookie
    const cookies = document.cookie.split(';').map(c => c.trim());
    for (const cookie of cookies) {
      if (cookie.startsWith(`${STORAGE_KEY}=`)) {
        const savedFile = cookie.split('=')[1];
        if (savedFile && VALID_FILES.includes(savedFile)) {
          console.log('[è¯»å–æˆåŠŸ] Cookieè®°å½•:', savedFile);
          return savedFile;
        }
      }
    }

    // é»˜è®¤è¿”å›ä¸»é¡µ
    console.log('[è¯»å–å¤±è´¥] æ— è®°å½•ï¼Œè¿”å›ä¸»é¡µ');
    return 'bpuxi.html';
  }

  // ================== 5. åˆ‡æ¢é¡µé¢ï¼ˆç›´æ¥æ‹¼æ¥è·¯å¾„ï¼Œæ— å†—ä½™é€»è¾‘ï¼‰ ==================
  function switchPage(pageKey) {
    const targetFile = `${pageKey}.html`;
    if (VALID_FILES.includes(targetFile)) {
      const targetPath = `./page/${targetFile}`;
      currentIframe.src = targetPath;
      console.log('[åˆ‡æ¢é¡µé¢] ç›®æ ‡è·¯å¾„:', targetPath);
      // åˆ‡æ¢åç«‹å³ä¿å­˜ï¼ˆé¿å…æœªåŠ è½½å®Œæˆå°±å…³é—­ï¼‰
      setTimeout(saveRecord, 500);
    }
  }

  // ================== 6. é¡µé¢åŠ è½½å®Œæˆåä¿å­˜è®°å½•ï¼ˆç¡®ä¿URLç¨³å®šï¼‰ ==================
  currentIframe.onload = function() {
    console.log('[iframeåŠ è½½å®Œæˆ] å¼€å§‹åŒæ­¥è®°å½•');
    saveRecord();
  }

  // ================== 7. å…³é—­/åˆ·æ–°æ—¶å¼ºåˆ¶ä¿å­˜ï¼ˆæ— å¼¹æ¡†ï¼‰ ==================
  window.onbeforeunload = function() {
    saveRecord();
    // ä¸è¿”å›ä»»ä½•å€¼ï¼Œå½»åº•æ¶ˆé™¤å¼¹æ¡†
  }

  // ================== åˆå§‹åŒ–ï¼šåŠ è½½ä¿å­˜çš„è®°å½• ==================
  window.onload = function() {
    const savedFile = loadRecord();
    const initPath = `./page/${savedFile}`;
    currentIframe.src = initPath;
    console.log('[åˆå§‹åŒ–å®Œæˆ] åŠ è½½è·¯å¾„:', initPath);
    // åˆå§‹åŒ–é—®å€™è¯­
    hellowl();
    setInterval(hellowl, 60000);
  }

  // ================== é—®å€™è¯­åŠŸèƒ½ ==================
  function hellowl() {
    const titleText = document.getElementById('titleText');
    const hour = new Date().getHours();
    let str = 'é˜ä¸‹ï¼Œè¯·ç¨ç­‰â€¦';
    if (hour >=23 || hour <3) str='é˜ä¸‹ï¼Œåˆå¤œäº†ï¼Œè¿˜ä¸ä¼‘æ¯å—ï¼Ÿ';
    else if (hour >=22) str='é˜ä¸‹ï¼Œæ˜¯æ—¶å€™ç¡è§‰äº†å‘¢ï¼';
    else if (hour >=18) str='é˜ä¸‹ï¼Œæ™šä¸Šå¥½ï¼';
    else if (hour >=13) str='é˜ä¸‹ï¼Œä¸‹åˆå¥½ï¼Œæœ‰å°è¯•ç¾å‘³çš„ä¸‹åˆèŒ¶å—ï¼Ÿ';
    else if (hour >=12) str='é˜ä¸‹ï¼Œåˆå¥½ï¼Œåˆé¥­é£Ÿç”¨äº†å—ï¼Ÿ';
    else if (hour >=8) str='é˜ä¸‹ï¼Œä¸Šåˆå¥½ï¼';
    else str='é˜ä¸‹ï¼Œæ—©ä¸Šå¥½ï¼';
    titleText.innerText = str;
  }
</script>
</body>
</html>